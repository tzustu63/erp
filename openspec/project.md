# Project Context

## Purpose

# 📘 進銷存暨營運決策分析系統

## 一、系統概述（Overview）

### 1.1 目的

本文件說明一套整合進銷存、財務對帳與決策分析的系統規格，
目的在於建立一個能同時支援「營運管理」與「決策分析」的資料化系統，
以實現 **資料一致、庫存即時、財務透明、決策數據化** 的營運目標。

### 1.2 系統範圍

此系統涵蓋從資料建立到決策分析的完整業務流程：

- 主資料管理（產品、廠商、客戶）
- 進貨與銷貨管理（主檔與明細）
- 發票與付款對帳
- 即時庫存追蹤與變化分析
- 歷史價格、比價、部門成本與毛利分析
- 月度/年度營運儀表板（Dashboard）

### 1.3 系統目標

| 目標          | 說明                                                  |
| ------------- | ----------------------------------------------------- |
| 📦 資料集中化 | 建立統一的產品、供應商、客戶與交易資料結構。          |
| 🔍 可追蹤性   | 所有單據（進貨單、銷貨單、發票、付款）可完整溯源。    |
| 🔄 庫存自動化 | 系統自動依進貨與銷貨更新庫存。                        |
| 📊 決策分析化 | 提供成本、價格與毛利等決策指標。                      |
| ☁️ 開放擴充性 | 採用開放規格（Open Spec），可擴充至資料庫或雲端系統。 |

---

## 二、系統架構（System Architecture）

### 2.1 分層架構

本系統採用 **五層模組化架構**：

| 層級        | 模組                                | 功能定位               |
| ----------- | ----------------------------------- | ---------------------- |
| 1️⃣ 主資料層 | 產品 / 廠商 / 客戶                  | 提供所有交易的參照依據 |
| 2️⃣ 交易層   | 進貨 / 銷貨（主檔與明細）           | 系統核心營運流程       |
| 3️⃣ 財務層   | 發票 / 付款紀錄                     | 對帳與金流管理         |
| 4️⃣ 庫存層   | 即時庫存                            | 自動追蹤庫存進出       |
| 5️⃣ 分析層   | 歷史價格 / 比價 / 部門支出 / 儀表板 | 決策支援與報表輸出     |

---

## 三、資料流程說明（Data Flow）

```
主資料（產品 / 廠商 / 客戶）
        ↓
進貨主檔 / 明細 ─→ 庫存（入庫）
        ↓
銷貨主檔 / 明細 ─→ 庫存（出庫）
        ↓
發票與付款（財務層）
        ↓
歷史價格 / 比價分析 / 部門支出資料
        ↓
儀表板資料（進貨 / 銷貨 / 毛利指標）
```

---

## 四、資料實體關聯圖（ERD）

```
Suppliers ──< Purchases ──< PurchaseDetails >── Products
Customers ──< Sales ──< SaleDetails >── Products
Sales ──< Payments
Purchases／Sales → Inventory（影響庫存）
```

### 4.1 關聯關係說明

| 來源             | 目標                  | 關係 | 說明                         |
| ---------------- | --------------------- | ---- | ---------------------------- |
| 廠商（Supplier） | 進貨主檔（Purchases） | 1:N  | 一個廠商可有多筆進貨單。     |
| 進貨主檔         | 進貨明細              | 1:N  | 每張進貨單可包含多項商品。   |
| 產品（Product）  | 進貨明細 / 銷貨明細   | 1:N  | 同一產品可在多筆交易中出現。 |
| 客戶（Customer） | 銷貨主檔（Sales）     | 1:N  | 一位客戶可有多筆銷售紀錄。   |
| 銷貨主檔         | 付款紀錄（Payments）  | 1:N  | 每張銷貨單可有多筆收款紀錄。 |
| 進貨 / 銷貨      | 庫存（Inventory）     | N:1  | 所有進出貨皆會更新庫存數量。 |

---

## 五、功能模組說明（Functional Modules）

### 5.1 主資料管理模組

**功能定位：系統基礎資料中心**

| 模組          | 功能                                 | 主要欄位                                 |
| ------------- | ------------------------------------ | ---------------------------------------- |
| 產品主檔 (10) | 記錄商品基本資訊、成本與售價         | 產品代碼、名稱、類別、單位、成本價、售價 |
| 廠商資料 (11) | 記錄供應商基本資料、聯絡人、付款條件 | 廠商代碼、名稱、統編、付款條件           |
| 客戶資料 (12) | 記錄客戶基本資料、聯絡人、信用條件   | 客戶代碼、名稱、統編、信用額度           |

---

### 5.2 進貨模組

**功能定位：採購與進貨管理**

| 模組          | 功能                     | 主要欄位                                   |
| ------------- | ------------------------ | ------------------------------------------ |
| 進貨主檔 (20) | 紀錄每次進貨的整體資料   | 進貨單號、廠商代碼、日期、金額、稅額、狀態 |
| 進貨明細 (21) | 記錄進貨項目與數量、單價 | 進貨單號、產品代碼、數量、單價、小計       |

📍**主要功能：**

- 記錄採購單與發票資訊
- 自動更新庫存（入庫）
- 建立歷史進貨價格供比價分析使用

---

### 5.3 銷貨模組

**功能定位：銷售與開立發票管理**

| 模組          | 功能                     | 主要欄位                                   |
| ------------- | ------------------------ | ------------------------------------------ |
| 銷貨主檔 (30) | 管理銷售單據與客戶資訊   | 銷貨單號、客戶代碼、日期、金額、稅額、狀態 |
| 銷貨明細 (31) | 記錄銷售商品、數量與售價 | 銷貨單號、產品代碼、數量、單價、小計       |

📍**主要功能：**

- 開立銷貨單與發票
- 自動更新庫存（出庫）
- 連結收款與發票紀錄

---

### 5.4 財務與對帳模組

**功能定位：金流管理與帳款追蹤**

| 模組                   | 功能                     | 主要欄位                                 |
| ---------------------- | ------------------------ | ---------------------------------------- |
| 付款紀錄 (40)          | 紀錄所有付款與收款資料   | 付款編號、關聯單號、日期、付款方式、金額 |
| 發票資料（嵌於主檔中） | 紀錄發票號碼、日期與稅額 | 發票號碼、日期、稅項、狀態               |

📍**主要功能：**

- 管理應收／應付帳款
- 支援部分付款、分期付款
- 對應發票與結帳狀態

---

### 5.5 庫存模組

**功能定位：即時存貨控制**

| 模組          | 功能                   | 主要欄位                                 |
| ------------- | ---------------------- | ---------------------------------------- |
| 即時庫存 (50) | 追蹤商品進出狀況與結餘 | 產品代碼、期初量、進貨量、銷貨量、現存量 |

📍**主要功能：**

- 自動計算商品存量
- 支援安全庫存警示與週轉率分析
- 可導出月度庫存報表

---

### 5.6 分析與決策模組

**功能定位：商業智慧（BI）與高層決策支援**

| 模組              | 功能                      | 主要欄位                           |
| ----------------- | ------------------------- | ---------------------------------- |
| 歷史進貨價格 (60) | 儲存各廠商歷史單價資料    | 廠商代碼、產品代碼、進貨日期、單價 |
| 比價分析來源 (61) | 用於不同廠商間的價格比較  | 產品代碼、廠商代碼、單價、日期     |
| 部門支出來源 (70) | 彙整各館別/部門的月度支出 | 年月、館別、部門、稅額、總金額     |
| 儀表板資料 (80)   | 提供 KPI 分析用資料       | 年月、指標類型、金額               |

📍**主要功能：**

- 成本控制與供應商價格分析
- 館別與部門支出報表
- 月度營運毛利與業績趨勢儀表板

---

## 六、報表與決策支援（Reporting & BI）

| 分析面向 | 指標                 | 可回答的問題                 |
| -------- | -------------------- | ---------------------------- |
| 成本分析 | 平均進貨價、廠商趨勢 | 哪個供應商長期最具價格優勢？ |
| 銷售績效 | 銷售總額、客戶排名   | 哪個部門／客戶貢獻最高？     |
| 庫存效率 | 週轉率、缺貨警示     | 哪些商品需補貨或滯銷？       |
| 財務對帳 | 未收／未付發票       | 哪些交易尚未結帳？           |
| 毛利表現 | 毛利率、部門貢獻     | 本月毛利變化與營運效率？     |

---

## 七、技術特性（Technical Characteristics）

| 項目       | 說明                                               |
| ---------- | -------------------------------------------------- |
| 平台       | 以 Excel 為基礎，可延伸至 Access、SQL 或雲端資料庫 |
| 結構       | 關聯式資料模型（1:N, N:1）                         |
| 模組化設計 | 各模組可獨立擴充與維護                             |
| 自動化能力 | 支援公式與樞紐表自動運算                           |
| 可視化整合 | 可與 Power BI、Tableau 等 BI 工具連接使用          |

---

## 八、開放規格原則（Open Spec Principles）

| 原則          | 說明                                   |
| ------------- | -------------------------------------- |
| 🔹 開放文件化 | 所有結構、欄位與關聯均透明可編輯。     |
| 🔹 協作演進   | 文件可隨專案持續更新與擴充。           |
| 🔹 相容整合   | 架構可與 ERP、會計或 BI 系統串接。     |
| 🔹 資料獨立性 | 交易資料與分析資料分層設計，提升效能。 |

---

## Tech Stack

- [List your primary technologies]
- [e.g., TypeScript, React, Node.js]

## Project Conventions

### Code Style

[Describe your code style preferences, formatting rules, and naming conventions]

### Architecture Patterns

[Document your architectural decisions and patterns]

### Testing Strategy

[Explain your testing approach and requirements]

### Git Workflow

[Describe your branching strategy and commit conventions]

## Domain Context

[Add domain-specific knowledge that AI assistants need to understand]

## Important Constraints

[List any technical, business, or regulatory constraints]

## External Dependencies

[Document key external services, APIs, or systems]
