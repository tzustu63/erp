## ADDED Requirements

### Requirement: 進貨主檔管理
系統 SHALL 提供進貨主檔（PurchaseMaster）管理功能，記錄每次進貨的整體資料。

#### Scenario: 建立進貨單
- **WHEN** 使用者輸入進貨資訊（進貨單號、廠商、日期、金額、稅額、狀態）
- **THEN** 系統自動產生進貨主檔 ID 並儲存資料
- **AND** 進貨單號必須唯一

#### Scenario: 自動計算總金額
- **WHEN** 進貨明細建立完成
- **THEN** 系統自動計算總金額與稅額
- **AND** 更新進貨主檔金額欄位

### Requirement: 進貨明細管理
系統 SHALL 提供進貨明細（PurchaseDetails）管理功能，記錄每筆進貨的商品細項。

#### Scenario: 新增進貨明細
- **WHEN** 使用者為進貨單新增明細（產品、數量、單價）
- **THEN** 系統自動計算小計（數量 × 單價）
- **AND** 建立與進貨主檔的關聯
- **AND** 自動更新對應產品的歷史價格

#### Scenario: 進貨後更新庫存
- **WHEN** 進貨單完成並設為「已入庫」狀態
- **THEN** 系統自動增加對應產品的庫存量
- **AND** 記錄進貨日期

#### Scenario: 查詢進貨紀錄
- **WHEN** 使用者查詢指定廠商或產品的進貨紀錄
- **THEN** 系統顯示所有相關進貨主檔與明細

#### Scenario: 歷史價格查詢
- **WHEN** 使用者查詢產品的歷史進貨價格
- **THEN** 系統顯示該產品所有進貨紀錄的單價與日期

